#鸟哥的LINUX私房菜
##文件与文件系统的压缩与打包
###Linux 系统常见的压缩命令
![composeFormat](/img/20220725/1.png)

这些命令通常仅能针对一个文件来压缩与解压缩，如此一来， 每次压缩与解压缩都要一大堆文件，岂不烦人？此时，那个所谓的『打包软件, tar』就显的很重要啦！

这个 tar 可以将很多文件『打包』成为一个文件！甚至是目录也可以这么玩。不过，单纯的 tar 功能仅是『打包』而已，亦即是将很多文件集结成为一个文件， 事实上，他并没有提供压缩的功能，后来，将整个 tar 与压缩的功能结合在一起，如此一来提供使用者更方便并且更强大的压缩与打包功能！
####gzip, zcat(cat 可以读取纯文字档， zcat 则可以读取纯文字档被压缩后的压缩档)
![2](/img/20220725/2.png)
![3](/img/20220725/3.png)

####bzip2, bzcat
 bzip2 则是为了取代 gzip 并提供更佳的压缩比而来的
 
 ![4](/img/20220725/4.png)
 
 
 ###打包命令: tar
 虽然 gzip 与 bzip2 也能够针对目录来进行压缩， 不过，这两个命令对目录的压缩指的是『将目录内的所有文件 "分别" 进行压缩』的动作！
  tar 可以将多个目录或文件打包成一个大文件，同时还可以透过 gzip/bzip2 的支持，将该文件同时进行压缩！ 
   
   ####tar
  ![5](/img/20220725/5.png)
  
  其实最简单的使用 tar 就只要记忆底下的方式即可：
  #####压　缩：tar -jcv -f filename.tar.bz2 要被压缩的文件或目录名称
  #####查　询：tar -jtv -f filename.tar.bz2
  #####解压缩：tar -jxv -f filename.tar.bz2 -C 欲解压缩的目录
  学习 tar 时，将『 -f filename 』与其他选项独立出来，会比较不容易发生问题
  
  ####使用 tar 加入 -j 或 -z 的参数备份 /etc/ 目录
  
  ![6](/img/20220725/6.png)
  
  使用 bzip2 亦即 -j 这个选项来制作备份时，能够得到比较好的压缩比
  
  至於加上『 -p 』这个选项的原因是为了保存原本文件的权限与属性！我们曾在第七章的 cp 命令介绍时谈到权限与文件类型(例如连结档)对复制的不同影响。 同样的，在备份重要的系统数据时，这些原本文件的权限需要做完整的备份比较好。此时 -p 这个选项就派的上用场了
  
  ###查阅 tar 文件的数据内容(可察看档名)，与备份档名有否根目录的意义
  ![7](/img/20220725/7.png)
  
  每个档名都没了根目录了！这也是上一个练习中出现的那个警告信息『tar: Removing leading `/' from member names(移除了档名开头的 `/' )』所告知的情况！
  
  那为什么要拿掉根目录呢？主要是为了安全！我们使用 tar 备份的数据可能会需要解压缩回来使用， 在 tar 所记录的档名 (就是我们刚刚使用 tar -jtvf 所察看到的档名) 那就是解压缩后的实际档名。 如果拿掉了根目录，假设你将备份数据在 /tmp 解开，那么解压缩的档名就会变成『/tmp/etc/xxx』。 但『如果没有拿掉根目录，解压缩后的档名就会是绝对路径， 亦即解压缩后的数据一定会被放置到 /etc/xxx 去！』如此一来，你的原本的 /etc/ 底下的数据， 就会被备份数据所覆盖过去了！
 
  ![8](/img/20220725/8.png)
  
  ###将备份的数据解压缩，并考虑特定目录的解压缩动作 (-C 选项的应用)
  
  ###仅解开单一文件的方法
  
  ![9](/img/20220725/9.png)
  
  ###打包某目录，但不含该目录下的某些文件之作法
  'tar -jcv -f /root/system.tar.bz2 --exclude=/root/etc* --exclude=/root/system.tar.bz2 /etc /root
'
###仅备份比某个时刻还要新的文件

![10](/img/20220725/10.png)

###特殊应用：利用管线命令与数据流
![11](/img/20220725/11.png)

###例题：系统备份范例
![12](/img/20220725/12.png)